#!/bin/bash
set -x #echo on

# Combine prediction for each chromsome
cat hmm_predictions/hmm3states1slot1covarContinuous.startpriors.LAB_V2_CNN_V4.gamma.GAN_input.chr1.3000.preds.plus.bed hmm_predictions/hmm3states1slot1covarContinuous.startpriors.LAB_V2_CNN_V4.gamma.GAN_input.chr2.3000.preds.plus.bed hmm_predictions/hmm3states1slot1covarContinuous.startpriors.LAB_V2_CNN_V4.gamma.GAN_input.chr3.3000.preds.plus.bed hmm_predictions/hmm3states1slot1covarContinuous.startpriors.LAB_V2_CNN_V4.gamma.GAN_input.chr4.3000.preds.plus.bed hmm_predictions/hmm3states1slot1covarContinuous.startpriors.LAB_V2_CNN_V4.gamma.GAN_input.chr5.3000.preds.plus.bed hmm_predictions/hmm3states1slot1covarContinuous.startpriors.LAB_V2_CNN_V4.gamma.GAN_input.chr6.3000.preds.plus.bed hmm_predictions/hmm3states1slot1covarContinuous.startpriors.LAB_V2_CNN_V4.gamma.GAN_input.chr7.3000.preds.plus.bed hmm_predictions/hmm3states1slot1covarContinuous.startpriors.LAB_V2_CNN_V4.gamma.GAN_input.chr8.3000.preds.plus.bed hmm_predictions/hmm3states1slot1covarContinuous.startpriors.LAB_V2_CNN_V4.gamma.GAN_input.chr9.3000.preds.plus.bed hmm_predictions/hmm3states1slot1covarContinuous.startpriors.LAB_V2_CNN_V4.gamma.GAN_input.chr10.3000.preds.plus.bed hmm_predictions/hmm3states1slot1covarContinuous.startpriors.LAB_V2_CNN_V4.gamma.GAN_input.chr11.3000.preds.plus.bed hmm_predictions/hmm3states1slot1covarContinuous.startpriors.LAB_V2_CNN_V4.gamma.GAN_input.chr12.3000.preds.plus.bed hmm_predictions/hmm3states1slot1covarContinuous.startpriors.LAB_V2_CNN_V4.gamma.GAN_input.chr13.3000.preds.plus.bed hmm_predictions/hmm3states1slot1covarContinuous.startpriors.LAB_V2_CNN_V4.gamma.GAN_input.chr14.3000.preds.plus.bed hmm_predictions/hmm3states1slot1covarContinuous.startpriors.LAB_V2_CNN_V4.gamma.GAN_input.chr15.3000.preds.plus.bed hmm_predictions/hmm3states1slot1covarContinuous.startpriors.LAB_V2_CNN_V4.gamma.GAN_input.chr16.3000.preds.plus.bed hmm_predictions/hmm3states1slot1covarContinuous.startpriors.LAB_V2_CNN_V4.gamma.GAN_input.chr17.3000.preds.plus.bed hmm_predictions/hmm3states1slot1covarContinuous.startpriors.LAB_V2_CNN_V4.gamma.GAN_input.chr18.3000.preds.plus.bed hmm_predictions/hmm3states1slot1covarContinuous.startpriors.LAB_V2_CNN_V4.gamma.GAN_input.chr19.3000.preds.plus.bed hmm_predictions/hmm3states1slot1covarContinuous.startpriors.LAB_V2_CNN_V4.gamma.GAN_input.chr20.3000.preds.plus.bed hmm_predictions/hmm3states1slot1covarContinuous.startpriors.LAB_V2_CNN_V4.gamma.GAN_input.chr21.3000.preds.plus.bed hmm_predictions/hmm3states1slot1covarContinuous.startpriors.LAB_V2_CNN_V4.gamma.GAN_input.chr22.3000.preds.plus.bed hmm_predictions/hmm3states1slot1covarContinuous.startpriors.LAB_V2_CNN_V4.gamma.GAN_input.chrX.3000.preds.plus.bed hmm_predictions/hmm3states1slot1covarContinuous.startpriors.LAB_V2_CNN_V4.gamma.GAN_input.chr1.3000.preds.minus.bed hmm_predictions/hmm3states1slot1covarContinuous.startpriors.LAB_V2_CNN_V4.gamma.GAN_input.chr2.3000.preds.minus.bed hmm_predictions/hmm3states1slot1covarContinuous.startpriors.LAB_V2_CNN_V4.gamma.GAN_input.chr3.3000.preds.minus.bed hmm_predictions/hmm3states1slot1covarContinuous.startpriors.LAB_V2_CNN_V4.gamma.GAN_input.chr4.3000.preds.minus.bed hmm_predictions/hmm3states1slot1covarContinuous.startpriors.LAB_V2_CNN_V4.gamma.GAN_input.chr5.3000.preds.minus.bed hmm_predictions/hmm3states1slot1covarContinuous.startpriors.LAB_V2_CNN_V4.gamma.GAN_input.chr6.3000.preds.minus.bed hmm_predictions/hmm3states1slot1covarContinuous.startpriors.LAB_V2_CNN_V4.gamma.GAN_input.chr7.3000.preds.minus.bed hmm_predictions/hmm3states1slot1covarContinuous.startpriors.LAB_V2_CNN_V4.gamma.GAN_input.chr8.3000.preds.minus.bed hmm_predictions/hmm3states1slot1covarContinuous.startpriors.LAB_V2_CNN_V4.gamma.GAN_input.chr9.3000.preds.minus.bed hmm_predictions/hmm3states1slot1covarContinuous.startpriors.LAB_V2_CNN_V4.gamma.GAN_input.chr10.3000.preds.minus.bed hmm_predictions/hmm3states1slot1covarContinuous.startpriors.LAB_V2_CNN_V4.gamma.GAN_input.chr11.3000.preds.minus.bed hmm_predictions/hmm3states1slot1covarContinuous.startpriors.LAB_V2_CNN_V4.gamma.GAN_input.chr12.3000.preds.minus.bed hmm_predictions/hmm3states1slot1covarContinuous.startpriors.LAB_V2_CNN_V4.gamma.GAN_input.chr13.3000.preds.minus.bed hmm_predictions/hmm3states1slot1covarContinuous.startpriors.LAB_V2_CNN_V4.gamma.GAN_input.chr14.3000.preds.minus.bed hmm_predictions/hmm3states1slot1covarContinuous.startpriors.LAB_V2_CNN_V4.gamma.GAN_input.chr15.3000.preds.minus.bed hmm_predictions/hmm3states1slot1covarContinuous.startpriors.LAB_V2_CNN_V4.gamma.GAN_input.chr16.3000.preds.minus.bed hmm_predictions/hmm3states1slot1covarContinuous.startpriors.LAB_V2_CNN_V4.gamma.GAN_input.chr17.3000.preds.minus.bed hmm_predictions/hmm3states1slot1covarContinuous.startpriors.LAB_V2_CNN_V4.gamma.GAN_input.chr18.3000.preds.minus.bed hmm_predictions/hmm3states1slot1covarContinuous.startpriors.LAB_V2_CNN_V4.gamma.GAN_input.chr19.3000.preds.minus.bed hmm_predictions/hmm3states1slot1covarContinuous.startpriors.LAB_V2_CNN_V4.gamma.GAN_input.chr20.3000.preds.minus.bed hmm_predictions/hmm3states1slot1covarContinuous.startpriors.LAB_V2_CNN_V4.gamma.GAN_input.chr21.3000.preds.minus.bed hmm_predictions/hmm3states1slot1covarContinuous.startpriors.LAB_V2_CNN_V4.gamma.GAN_input.chr22.3000.preds.minus.bed hmm_predictions/hmm3states1slot1covarContinuous.startpriors.LAB_V2_CNN_V4.gamma.GAN_input.chrX.3000.preds.minus.bed | awk 'BEGIN { OFS = "\t" } ; (substr($1,1,3) == "chr") {print $0}' | LC_ALL=C sort -k1,1 -k2,2n > hmm_predictions/hmm3states1slot1covarContinuous.startpriors.LAB_V2_CNN_V4.gamma.GAN_input.all.3000.preds.bed

# Convert to bigwig
# ../ucsc_tools/bedGraphToBigWig hmm_predictions/hmm3states1slot1covarContinuous.startpriors.LAB_V2_CNN_V4.gamma.GAN_input.all.3000.preds.plus.bedgraph ref_files/hg19.genome hmm_predictions/hmm3states1slot1covarContinuous.startpriors.LAB_V2_CNN_V4.gamma.GAN_input.all.3000.preds.plus.bw
